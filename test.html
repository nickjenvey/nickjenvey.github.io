<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hover Effect Demo</title>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/dynamics.js@1.0.0/dynamics.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tinycolor/1.4.1/tinycolor.min.js"></script>
  <style>
    body {
      font-family: 'Open Sans', sans-serif;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    #page {
      width: 100%;
      height: 100vh;
      position: relative;
      overflow: hidden;
    }

    #logo-container {
      position: absolute;
      top: 20%;
      left: 50%;
      transform: translateX(-50%);
      visibility: hidden;
    }

    #intro {
      position: absolute;
      width: 100%;
      height: 100%;
      background-color: #101214;
      display: flex;
      justify-content: center;
      align-items: center;
      color: #fff;
      text-align: center;
    }

    .content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      visibility: hidden;
    }
  </style>
</head>
<body>

  <div id="page">
    <div id="intro">
      <div>
        <h1>Welcome to My Site</h1>
        <p>This is the intro text</p>
      </div>
    </div>

    <div id="logo-container">
      <svg id="header-logo" width="120" height="120" xmlns="http://www.w3.org/2000/svg">
        <path d="M 10,10 L 110,10 L 110,110 L 10,110 Z" stroke="black" fill="none"/>
      </svg>
    </div>

    <div id="content" class="content">
      <h2>Hover Effect Demo</h2>
      <p>Check out this hover effect</p>
    </div>

    <div id="clip-paths">
      <g></g>
    </div>

  </div>

  <script>
    // Helper Functions
    function createEl(template) {
      let el = document.createElement('div');
      el.innerHTML = template.trim();
      return el.firstChild;
    }

    function createSvgEl(template) {
      let el = createEl(`
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">${template.trim()}</svg>
      `);
      return el;
    }

    function createSvgChildEl(template) {
      return createSvgEl(template).firstChild;
    }

    function createLine(options) {
      let el = createSvgChildEl(`
        <rect x="${options.x}" y="${options.y}" width="${options.width}" height="${options.height}" fill="${options.color}">
      `);
      return el;
    }

    // Create Masks with Stripes
    let totalMaskIdx = 0;
    function createMasksWithStripes(count, box, averageHeight = 10) {
      let masks = [];
      for (let i = 0; i < count; i++) {
        masks.push([]);
      }
      let maskNames = [];
      for (let i = totalMaskIdx; i < totalMaskIdx + masks.length; i++) {
        maskNames.push(`clipPath${i}`);
      }
      totalMaskIdx += masks.length;
      let maskIdx = 0;
      let x = 0;
      let y = 0;
      let stripeHeight = averageHeight;
      while (true) {
        let w = Math.max(stripeHeight * 10, Math.round(Math.random() * box.width));
        masks[maskIdx].push(`
          M ${x},${y} L ${x + w},${y} L ${x + w},${y + stripeHeight} L ${x},${y + stripeHeight} Z
        `);

        maskIdx += 1;
        if (maskIdx >= masks.length) {
          maskIdx = 0;
        }

        x += w;
        if (x > box.width) {
          x = 0;
          y += stripeHeight;
          stripeHeight = Math.round(Math.random() * averageHeight + averageHeight / 2);
        }
        if (y >= box.height) {
          break;
        }
      }

      masks.forEach(function (rects, i) {
        let el = createSvgChildEl(`<clipPath id="${maskNames[i]}">
          <path d="${rects.join(' ')}" fill="white"></path>
        </clipPath>`);
        document.querySelector('#clip-paths g').appendChild(el);
      });

      return maskNames;
    }

    function cloneAndStripeElement(element, clipPathName, parent) {
      let el = element.cloneNode(true);
      let box = element.getBoundingClientRect();
      let parentBox = parent.getBoundingClientRect();
      box = {
        top: box.top - parentBox.top,
        left: box.left - parentBox.left,
        width: box.width,
        height: box.height,
      };
      let style = window.getComputedStyle(element);

      dynamics.css(el, {
        position: 'absolute',
        left: Math.round(box.left + window.scrollX),
        top: Math.round(box.top + window.scrollY),
        width: Math.ceil(box.width),
        height: Math.ceil(box.height),
        display: 'none',
        pointerEvents: 'none',
        background: '#101214',
        fontSize: style.fontSize,
        fontFamily: style.fontFamily,
        color: style.color,
        textDecoration: style.textDecoration,
      });
      parent.appendChild(el);
      el.style['-webkit-clip-path'] = `url(/#${clipPathName})`;
      el.style['clip-path'] = `url(/#${clipPathName})`;

      return el;
    }

    // Animate Functions
    function animateBlackStripes(container, options = {}) {
      options.sizeRatio = 3;
      options.color = '#101214';
      options.delay = function (type, i) {
        if (type === 'show') {
          return Math.random() * 50;
        } else if (type === 'transform') {
          return Math.random() * 20 + i * 2;
        } else if (type === 'hide') {
          return 100;
        }
      };
      options.transform = function (size) {
        return {
          width: size.width / 2,
          height: size.height / 5,
        };
      };
      _animateStripes(container, options);
    }

    function animateColoredStripes(container, options = {}) {
      options.delay = function (type, i) {
        if (type === 'show') {
          return Math.random() * 300;
        } else if (type === 'transform') {
          return Math.random() * 20;
        } else if (type === 'hide') {
          return 100;
        }
      };
      options.transform = function (size) {
        return {
          width: size.width / 2,
          height: size.height / 5,
        };
      };
      _animateStripes(container, options);
    }

    function _animateStripes(container, options = {}) {
      options.count = options.count || 10;
      options.sizeRatio = options.sizeRatio || 1;
      let stripes = [];
      for (let i = 0; i < options.count; i++) {
        let color = options.color || tinycolor(`hsl(${Math.round(Math.random() * 360)}, 80%, 65%)`).toRgbString();
        let baseWidth = Math.max(window.innerWidth, 1000);
        let width = Math.round(baseWidth / 10 + Math.random() * baseWidth / 10) * options.sizeRatio;
        let height = Math.round(Math.random() * 10 + 2) * options.sizeRatio;
        let point = options.point || {
          x: Math.round((window.innerWidth + width) * Math.random() - width),
          y: Math.round(window.innerHeight * Math.random()),
        };
        let lineOptions = {
          x: point.x,
          y: point.y,
          width: width,
          height: height,
          color: color,
        };
        let lineEl = createLine(lineOptions);
        lineEl.style.display = 'none';
        container.appendChild(lineEl);

        dynamics.setTimeout(function () {
          lineEl.style.display = 'block';

          dynamics.setTimeout(function () {
            lineOptions.x += Math.random() * 100 - 50;
            lineOptions.y += Math.random() * 20 - 10;
            lineEl.setAttribute('x', lineOptions.x);
            lineEl.setAttribute('y', lineOptions.y);

            let newLineOptions = options.transform({
              width: lineOptions.width,
              height: lineOptions.height,
            });
            lineEl.setAttribute('width', newLineOptions.width);
            lineEl.setAttribute('height', newLineOptions.height);

            dynamics.setTimeout(function () {
              container.removeChild(lineEl);
            }, options.delay('hide', i));
          }, options.delay('transform', i));
        }, options.delay('show', i));

        stripes.push(lineEl);
      }
      return stripes;
    }

    // Animation Start
    (function () {
      animateBlackStripes(document.querySelector('#intro'), { count: 200 });
      animateColoredStripes(document.querySelector('#intro'), { count: 100 });

      let logoContainer = document.querySelector('#logo-container');
      dynamics.css(logoContainer, {
        scale: 0.5,
        translateX: Math.random() * 100 - 50,
      });

      dynamics.setTimeout(function () {
        dynamics.css(logoContainer, {
          translateX: 10,
          scale: 0.55,
        });
      }, 100);

      dynamics.setTimeout(function () {
        dynamics.css(logoContainer, {
          translateX: 0,
          scale: 0.5,
        });
      }, 150);

      dynamics.setTimeout(function () {
        logoContainer.style.visibility = 'visible';
      }, 1);

      dynamics.setTimeout(function () {
        animateBlackStripes(document.querySelector('#intro'), { count: 200 });
        animateColoredStripes(document.querySelector('#intro'), { count: 100 });
      }, 1000);

      dynamics.setTimeout(function () {
        introEl.style.backgroundColor = 'transparent';
        dynamics.css(logoContainer, {
          scale: 1,
          translateX: Math.random() * window.innerWidth - window.innerWidth / 2,
          translateY: Math.random() * window.innerHeight - window.innerHeight / 2,
        });
      }, 1300);
    })();
  </script>
</body>
</html>
